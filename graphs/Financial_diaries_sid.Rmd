---
title: "Financial_Diaries"
author: "Siddarth Ravikanti"
date: "6/21/2022"
output:
  pdf_document: default
  html_document: default
---

###Financial Diaries

```{r setup, include = FALSE}
library(lubridate)
library(dplyr)
library(ggplot2)
#load("~/Documents/2022-DSPG-LivDiv-/data/livdivdata.RData")
fin_diary <- livdiv %>% select(village, date, week, name, full_inc) %>% arrange(week, village) %>% group_by(week) 

library(lubridate)
fin_diary$date <- as_date(fin_diary$date)

#fin_diary <- fin_diary %>% mutate_at(5, ~replace_na(.,0))
avg_tot_inc <- fin_diary %>% group_by(date, village, week) %>% summarize(avg_inc = mean(full_inc, na.rm = TRUE))

avg_tot_inc2 <- fin_diary %>% group_by(week) %>% summarize(avg_inc = mean(full_inc, na.rm = TRUE))

avg_inc_Amrabati <- fin_diary %>% group_by(date, village, week) %>% filter(village == "Amrabati") %>% summarize(avg_inc = mean(full_inc, na.rm = TRUE))

avg_inc_Begu <- fin_diary %>% group_by(date, village, week) %>% filter(village == "Beguakhali") %>% summarize(avg_inc = mean(full_inc, na.rm = TRUE))

avg_inc_Bijoy <- fin_diary %>% group_by(date, village, week) %>% filter(village == "Bijoynagar") %>% summarize(avg_inc = mean(full_inc, na.rm = TRUE))

avg_inc_Biraj <- fin_diary %>% group_by(date, village, week) %>% filter(village == "Birajnagar") %>% summarize(avg_inc = mean(full_inc, na.rm = TRUE))

avg_inc_Hari <- fin_diary %>% group_by(date, village, week) %>% filter(village == "Haridaskati Samsernagar") %>% summarize(avg_inc = mean(full_inc, na.rm = TRUE))

avg_inc_Laksh <- fin_diary %>% group_by(date, village, week) %>% filter(village == "Lakshmi Janardanpur") %>% summarize(avg_inc = mean(full_inc, na.rm = TRUE))

avg_inc_Parg <- fin_diary %>% group_by(date, village, week) %>% filter(village == "Pargumti") %>% summarize(avg_inc = mean(full_inc, na.rm = TRUE))

avg_inc_Purba <- fin_diary %>% group_by(date, village, week) %>% filter(village == "Purba Dwarokapur") %>% summarize(avg_inc = mean(full_inc, na.rm = TRUE))

avg_inc_Sagar <- fin_diary %>% group_by(date, village, week) %>% filter(village == "Sagar") %>% summarize(avg_inc = mean(full_inc, na.rm = TRUE))

avg_inc_Shibpur <- fin_diary %>% group_by(date, village, week) %>% filter(village == "Shibpur") %>% summarize(avg_inc = mean(full_inc, na.rm = TRUE))

```

```{r}
ggplot(avg_tot_inc, aes(week, avg_inc)) + geom_line() +
  labs(x = "", y = "Income (INR)", title = "Average Weekly Household Income")
```


#The mean for the average total household income is 1395.6 rupees and the median is 1341.8 rupees per week
#The min for the total income is 257.5 rupees and the max is 7598.3 rupees
```{r}
ggplot(avg_tot_inc2, aes(week, avg_inc)) + geom_line(color = "white") + labs(x = "", y = "Income (INR)", title = "Weekly Household Income") + scale_x_discrete(breaks = c(10,20,30,40), labels = c("January 2019", "April 2019", "July 2019", "October 2019"), limits = 10:40) + theme_dark()
```
This plot averages out the weekly income for every household over the year span that the financial diaries were collected. Spikes of income can mean many things, such as harvest time, salary bonuses, or an addition of remittance to weekly income. The biggest spike, coming around late march indicates the largest harvest for the farmers. In addition, dips in the plot can indicate many things such as shocks from environmental impacts or other unexpected household incidents. 


```{r}
ggplot(avg_tot_inc, aes(week, avg_inc, color = village)) + geom_line() + 
  labs(x = "", y = "Income (INR)", 
       title = "Average Weekly Household Income by village", color = "Village")

```


```{r}
ggplot(avg_tot_inc, aes(date, avg_inc, color = village)) + geom_line() + labs(x = "", y = "Income (INR)", title = "Average Weekly Household Income by village", color = "Village") 
```

